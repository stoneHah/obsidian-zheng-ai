<%*
const summary = await tp.system.prompt("ğŸ§  ç®€è¦æ€»ç»“è¿™æ¡å†…å®¹ï¼š")
const tags = await tp.system.prompt("ğŸ·ï¸ æ·»åŠ æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼Œå¦‚ï¼šAI,å¿ƒç†,è¶‹åŠ¿ï¼‰ï¼š")
const folder = await tp.system.prompt("ğŸ“ å½’æ¡£æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆå¦‚ï¼šNotes/AI/æ¨æ–‡ï¼‰ï¼š")

// æ¸…ç†æ—§æ ‡ç­¾å¹¶æ·»åŠ æ–°æ ‡ç­¾
let tagList = tags.split(",").map(t => t.trim()).filter(Boolean)
tagList.push("æ•´ç†å®Œæ¯•")  // æ·»åŠ æ ‡è®°
const tagLine = `tags: [${tagList.join(", ")}]`

// æ›´æ–° YAML åŒºå—
const newFrontmatter = `---
${tagLine}
processed: <% tp.date.now("YYYY-MM-DD") %>
---
`

// è·å–æ­£æ–‡å†…å®¹
const body = await tp.file.content.slice(tp.file.content.indexOf('---', 3) + 3)

// é‡å†™æ•´ä¸ªæ–‡ä»¶å†…å®¹ï¼ˆæ›¿æ¢åŸ frontmatterï¼‰
await tp.file.write(newFrontmatter + "\n" + body)

// ç§»åŠ¨åˆ°ç›®æ ‡æ–‡ä»¶å¤¹
if (folder) {
  await tp.file.move(`${folder}/${tp.file.title}`)
}
%>
